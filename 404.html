<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Redirectingâ€¦</title>
        <script>
            ;(function () {
                var l = window.location

                // try to read a <base href="..."> if present (recommended)
                var baseEl = document.querySelector && document.querySelector('base')
                var base = (baseEl && baseEl.getAttribute('href')) || '/'

                // normalize base to start & end with single slash
                if (base.charAt(0) !== '/') base = '/' + base
                if (base.charAt(base.length - 1) !== '/') base = base + '/'

                // fallback: if base is "/" but pathname looks like "/reponame/..." infer first segment
                if (base === '/') {
                    var parts = l.pathname.split('/')
                    // parts: ["", "reponame", "about", ...]
                    if (parts.length > 2 && parts[1]) {
                        base = '/' + parts[1] + '/'
                    }
                }

                // remove the base prefix from pathname (if present) to get the original SPA route
                var original = l.pathname
                if (original.indexOf(base) === 0) {
                    original = original.slice(base.length)
                } else {
                    // if base wasn't detected, keep the full pathname minus leading slash
                    original = original.replace(/^\/+/, '')
                }

                // strip trailing slash
                original = original.replace(/\/$/, '')

                // build search part (preserve query but encode ? -> ~and~ as spa-github-pages does)
                var search = l.search ? '&' + l.search.slice(1).replace(/\?/g, '~and~') : ''

                // redirect to base + '?/' + original (if original empty this becomes base + '?/')
                var redirect =
                    l.protocol +
                    '//' +
                    l.host +
                    base +
                    '?/' +
                    encodeURIComponent(original).replace(/%2F/g, '/') +
                    search +
                    l.hash
                l.replace(redirect)
            })()
        </script>
    </head>
    <body></body>
</html>
